<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio ENEM - Dinâmico</title>
    <style>
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #eef2f7; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: center; min-height: 90vh; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); width: 100%; max-width: 700px; position: relative; }
        
        /* Cronômetro */
        #timer-display {
            position: absolute; top: -20px; right: 20px;
            background-color: #2c3e50; color: white; padding: 10px 25px;
            border-radius: 30px; font-size: 1.5rem; font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: background-color 0.3s;
        }
        .timer-danger { background-color: #e74c3c !important; animation: pulse 1s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        h1 { color: #34495e; text-align: center; margin-bottom: 5px; }
        .progress-text { text-align: center; color: #7f8c8d; margin-bottom: 25px; font-size: 0.9rem; }

        /* Estilos da Questão */
        .question-box { margin-bottom: 25px; }
        .question-text { font-size: 1.2rem; font-weight: 600; color: #2c3e50; margin-bottom: 20px; line-height: 1.4; }
        .option-label { display: flex; align-items: center; padding: 12px 15px; margin: 8px 0; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
        .option-label:hover { background-color: #f8f9fa; border-color: #bdc3c7; }
        input[type="radio"] { margin-right: 15px; transform: scale(1.2); }
        input[type="radio"]:checked + span { font-weight: bold; color: #2980b9; }
        .option-label:has(input:checked) { border-color: #3498db; background-color: #ebf5fb; }

        /* Botão */
        #next-btn { width: 100%; padding: 15px; background-color: #3498db; color: white; font-size: 1.2rem; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: background 0.2s; }
        #next-btn:hover { background-color: #2980b9; }

        /* Tela de Resultados */
        #result-container { text-align: center; display: none; }
        .score-big { font-size: 4rem; font-weight: bold; color: #27ae60; margin: 20px 0; }
        .score-details { color: #7f8c8d; }
    </style>
</head>
<body>

    <div class="card">
        <div id="timer-display">03:00</div>
        
        <div id="quiz-active">
            <h1>Desafio ENEM</h1>
            <p class="progress-text" id="progress">Questão 1 de 10</p>
            
            <div id="quiz-container">
                </div>

            <button id="next-btn" onclick="verificarEProxima()">Próxima Questão ›</button>
        </div>

        <div id="result-container">
            <h1>Quiz Finalizado!</h1>
            <p>Seu resultado foi:</p>
            <div class="score-big" id="final-score">0/0</div>
            <p class="score-details" id="final-feedback"></p>
            <button id="next-btn" onclick="location.reload()" style="background-color: #27ae60; margin-top: 20px;">Tentar Novamente</button>
        </div>

    </div>

    <script>
        // --- BANCO DE QUESTÕES ---
        const questoes = [
            { q: "1. (Matemática) Escala 1:200.000. Distância no mapa 4 cm. Qual a distância real?", options: ["8 km", "80 km", "0,8 km", "800 km"], correct: 0 },
            { q: "2. (Biologia) A eutrofização em rios, após a morte das algas, causa:", options: ["Aumento do oxigênio", "Diminuição do oxigênio dissolvido", "Diminuição da temperatura", "Aumento da salinidade"], correct: 1 },
            { q: "3. (História) A Revolta da Vacina (1904) ocorreu no contexto:", options: ["Da Independência", "Das reformas urbanas no Rio e vacinação obrigatória", "Da Abolição da Escravatura", "Do Golpe Militar de 64"], correct: 1 },
            { q: "4. (Química) Melhor método para separar água e óleo:", options: ["Filtração", "Decantação", "Destilação simples", "Levigação"], correct: 1 },
            { q: "5. (Literatura) Principal característica do Modernismo (1922):", options: ["Busca por identidade nacional e ruptura com o passado", "Métrica e rima rigorosas", "Imitação dos clássicos portugueses", "Foco exclusivo em temas religiosos"], correct: 0 },
            { q: "6. (Física) Um carro faz 150km em 2h. Qual a velocidade média?", options: ["75 km/h", "100 km/h", "300 km/h", "50 km/h"], correct: 0 },
            { q: "7. (Geografia) Adaptação típica da vegetação da Caatinga:", options: ["Folhas grandes e largas", "Espinhos e raízes profundas (xerófilas)", "Árvores de grande porte e copas densas", "Raízes aéreas (pneumatóforos)"], correct: 1 },
            { q: "8. (Matemática) Tênis de R$ 200,00 com 20% de desconto. Valor final:", options: ["R$ 160,00", "R$ 180,00", "R$ 140,00", "R$ 40,00"], correct: 0 },
            { q: "9. (Filosofia) Ideia central em 'O Príncipe' de Maquiavel:", options: ["O governante deve seguir a moral cristã", "Os fins justificam os meios na política", "O poder deve ser dividido em três", "O homem nasce bom e a sociedade o corrompe"], correct: 1 },
            { q: "10. (Biologia) Função principal das mitocôndrias:", options: ["Síntese de proteínas", "Respiração celular e produção de energia", "Fotossíntese", "Digestão intracelular"], correct: 1 }
        ];

        // --- VARIÁVEIS DE ESTADO ---
        let indiceAtual = 0;
        let pontuacao = 0;
        let tempoRestante; // Segundos restantes na questão atual
        let timerInterval;
        const TEMPO_POR_QUESTAO = 180; // 3 minutos em segundos

        // Elementos do DOM
        const quizContainer = document.getElementById('quiz-container');
        const timerDisplay = document.getElementById('timer-display');
        const progressText = document.getElementById('progress');
        const activeScreen = document.getElementById('quiz-active');
        const resultScreen = document.getElementById('result-container');

        // --- FUNÇÕES PRINCIPAIS ---

        // 1. Inicia o Quiz (chamada ao carregar a página)
        function iniciarQuiz() {
            carregarQuestao(indiceAtual);
        }

        // 2. Carrega a questão na tela baseado no índice
        function carregarQuestao(index) {
            clearInterval(timerInterval); // Para o cronômetro anterior
            tempoRestante = TEMPO_POR_QUESTAO; // Reseta o tempo
            atualizarDisplayTimer();
            timerDisplay.classList.remove('timer-danger'); // Remove alerta de cor
            
            progressText.innerText = `Questão ${index + 1} de ${questoes.length}`;
            
            const qData = questoes[index];
            let html = `<div class="question-box">
                            <div class="question-text">${qData.q}</div>
                            <div class="options-list">`;
            
            qData.options.forEach((opt, i) => {
                html += `<label class="option-label">
                            <input type="radio" name="opcao" value="${i}">
                            <span>${opt}</span>
                         </label>`;
            });

            html += `</div></div>`;
            quizContainer.innerHTML = html;
            
            iniciarCronometro();
        }

        // 3. Lógica do Cronômetro
        function iniciarCronometro() {
            timerInterval = setInterval(() => {
                tempoRestante--;
                atualizarDisplayTimer();

                // Muda cor quando faltam 30 segundos
                if (tempoRestante <= 30) {
                    timerDisplay.classList.add('timer-danger');
                }

                // Tempo esgotado
                if (tempoRestante <= 0) {
                    clearInterval(timerInterval);
                    lidarComTimeout();
                }
            }, 1000);
        }

        function atualizarDisplayTimer() {
            let m = Math.floor(tempoRestante / 60);
            let s = tempoRestante % 60;
            timerDisplay.innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        // 4. Quando o tempo acaba sozinho
        function lidarComTimeout() {
            // Se o tempo acabou, conta como errado e avança.
            // Opcional: dar um alerta visual rápido antes de mudar.
            timerDisplay.innerText = "TEMPO!";
            setTimeout(() => {
                 avancarParaProxima(false); // Passa 'false' pois não acertou
            }, 1000);
        }

        // 5. Quando o usuário clica no botão "Próxima"
        function verificarEProxima() {
            clearInterval(timerInterval); // Para o tempo
            
            const opcaoSelecionada = document.querySelector('input[name="opcao"]:checked');
            let acertou = false;

            if (opcaoSelecionada) {
                const respostaUsuario = parseInt(opcaoSelecionada.value);
                if (respostaUsuario === questoes[indiceAtual].correct) {
                    acertou = true;
                }
            }
            // Se não selecionou nada, 'acertou' continua false.

            avancarParaProxima(acertou);
        }

        // 6. Função central para mudar o estado do jogo
        function avancarParaProxima(foiCorreta) {
            if (foiCorreta) {
                pontuacao++;
            }
            
            indiceAtual++;

            if (indiceAtual < questoes.length) {
                // Se ainda tem questões, carrega a próxima
                carregarQuestao(indiceAtual);
            } else {
                // Se acabou, mostra o resultado final
                mostrarResultadoFinal();
            }
        }

        // 7. Tela Final
        function mostrarResultadoFinal() {
            activeScreen.style.display = 'none';
            timerDisplay.style.display = 'none';
            resultScreen.style.display = 'block';

            const scoreElem = document.getElementById('final-score');
            const feedbackElem = document.getElementById('final-feedback');

            scoreElem.innerText = `${pontuacao}/${questoes.length}`;

            let mensagem = "";
            let porcentagem = (pontuacao / questoes.length) * 100;

            if (porcentagem >= 80) mensagem = "Excelente! Você está muito bem preparado.";
            else if (porcentagem >= 60) mensagem = "Bom trabalho! Mas ainda pode melhorar.";
            else mensagem = "Precisa estudar mais os temas base. Tente novamente!";
            
            feedbackElem.innerText = mensagem;
        }

        // INICIALIZAÇÃO
        iniciarQuiz();

    </script>
</body>
</html>
